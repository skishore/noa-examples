{"version":3,"file":"webgpuShaderProcessingContext.js","sourceRoot":"","sources":["../../../../sourceES6/core/Engines/WebGPU/webgpuShaderProcessingContext.ts"],"names":[],"mappings":"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AAC,CAAC,EAAE,EAAE;QAC5D,QAAQ,EAAG,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,QAAQ,EAAG,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,QAAQ,EAAG,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,QAAQ,EAAG,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC5D,UAAU,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;QAC7D,MAAM,EAAM,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE;KAChE,CAAC;IAEe,wCAAU,GAA+C;QACtE,OAAO,EAAI,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,EAAE;QAE1D,QAAQ,EAAG,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,EAAE;QAC1D,QAAQ,EAAG,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,EAAE;QAC1D,QAAQ,EAAG,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,EAAE;QAC1D,QAAQ,EAAG,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,EAAE;QAC1D,QAAQ,EAAG,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,EAAE;QAC1D,QAAQ,EAAG,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,EAAE;QAC1D,QAAQ,EAAG,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,EAAE;QAC1D,QAAQ,EAAG,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,EAAE;QAC1D,QAAQ,EAAG,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,EAAE;QAC1D,QAAQ,EAAG,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,EAAE;QAC1D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAC3D,SAAS,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE;QAE3D,UAAU,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,EAAE;QAC3D,MAAM,EAAM,EAAE,OAAO,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,EAAE;KAC9D,CAAC;IA4HN,oCAAC;CAAA,AA9MD,IA8MC;SA9MY,6BAA6B","sourcesContent":["import { ShaderLanguage } from \"../../Materials/shaderLanguage\";\nimport { ShaderProcessingContext } from \"../Processors/shaderProcessingOptions\";\n\nconst _maxGroups = 4;\nconst _maxBindingsPerGroup = 1 << 16;\n\n// all types not listed are assumed to consume 1 location\nconst _typeToLocationSize: { [key: string]: number } = {\n    // GLSL types\n    \"mat2\": 2,\n    \"mat3\": 3,\n    \"mat4\": 4,\n\n    // WGSL types\n    \"mat2x2\": 2,\n    \"mat3x3\": 3,\n    \"mat4x4\": 4,\n};\n\n/** @hidden */\nexport interface WebGPUBindingInfo {\n    groupIndex: number;\n    bindingIndex: number;\n}\n\n/** @hidden */\nexport interface WebGPUTextureDescription {\n    autoBindSampler?: boolean;\n    isTextureArray: boolean;\n    isStorageTexture: boolean;\n    textures: Array<WebGPUBindingInfo>;\n    sampleType?: GPUTextureSampleType; // not used if the texture is a storage texture\n}\n\n/** @hidden */\nexport interface WebGPUSamplerDescription {\n    binding: WebGPUBindingInfo;\n    type: GPUSamplerBindingType;\n}\n\n/** @hidden */\nexport interface WebGPUBufferDescription {\n    binding: WebGPUBindingInfo;\n}\n\n/** @hidden */\nexport interface WebGPUBindGroupLayoutEntryInfo {\n    name: string;\n    index: number; // index of the entry (GPUBindGroupLayoutEntry) in the bindGroupLayoutEntries[group] array\n    nameInArrayOfTexture?: string; // something like texture0, texture1, ... if texture is an array, else same thing as \"name\"\n}\n\n/**\n * @hidden\n */\nexport class WebGPUShaderProcessingContext implements ShaderProcessingContext {\n\n    /** @hidden */\n    public static _SimplifiedKnownBindings = true;  // if true, use only group=0,binding=0 as a known group/binding for the Scene ubo and use group=1,binding=X for all other bindings\n                                                    // if false, see _KnownUBOs for the known groups/bindings used\n\n    protected static _SimplifiedKnownUBOs: { [key: string]: WebGPUBufferDescription } = {\n        \"Scene\":   { binding: { groupIndex: 0, bindingIndex: 0 } },\n        \"Light0\":  { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light1\":  { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light2\":  { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light3\":  { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light4\":  { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light5\":  { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light6\":  { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light7\":  { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light8\":  { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light9\":  { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light10\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light11\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light12\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light13\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light14\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light15\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light16\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light17\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light18\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light19\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light20\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light21\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light22\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light23\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light24\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light25\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light26\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light27\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light28\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light29\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light30\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Light31\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Material\": { binding: { groupIndex: -1, bindingIndex: -1 } },\n        \"Mesh\":     { binding: { groupIndex: -1, bindingIndex: -1 } },\n    };\n\n    protected static _KnownUBOs: { [key: string]: WebGPUBufferDescription } = {\n        \"Scene\":   { binding: { groupIndex: 0, bindingIndex: 0 } },\n\n        \"Light0\":  { binding: { groupIndex: 1, bindingIndex: 0 } },\n        \"Light1\":  { binding: { groupIndex: 1, bindingIndex: 1 } },\n        \"Light2\":  { binding: { groupIndex: 1, bindingIndex: 2 } },\n        \"Light3\":  { binding: { groupIndex: 1, bindingIndex: 3 } },\n        \"Light4\":  { binding: { groupIndex: 1, bindingIndex: 4 } },\n        \"Light5\":  { binding: { groupIndex: 1, bindingIndex: 5 } },\n        \"Light6\":  { binding: { groupIndex: 1, bindingIndex: 6 } },\n        \"Light7\":  { binding: { groupIndex: 1, bindingIndex: 7 } },\n        \"Light8\":  { binding: { groupIndex: 1, bindingIndex: 8 } },\n        \"Light9\":  { binding: { groupIndex: 1, bindingIndex: 9 } },\n        \"Light10\": { binding: { groupIndex: 1, bindingIndex: 10 } },\n        \"Light11\": { binding: { groupIndex: 1, bindingIndex: 11 } },\n        \"Light12\": { binding: { groupIndex: 1, bindingIndex: 12 } },\n        \"Light13\": { binding: { groupIndex: 1, bindingIndex: 13 } },\n        \"Light14\": { binding: { groupIndex: 1, bindingIndex: 14 } },\n        \"Light15\": { binding: { groupIndex: 1, bindingIndex: 15 } },\n        \"Light16\": { binding: { groupIndex: 1, bindingIndex: 16 } },\n        \"Light17\": { binding: { groupIndex: 1, bindingIndex: 17 } },\n        \"Light18\": { binding: { groupIndex: 1, bindingIndex: 18 } },\n        \"Light19\": { binding: { groupIndex: 1, bindingIndex: 19 } },\n        \"Light20\": { binding: { groupIndex: 1, bindingIndex: 20 } },\n        \"Light21\": { binding: { groupIndex: 1, bindingIndex: 21 } },\n        \"Light22\": { binding: { groupIndex: 1, bindingIndex: 22 } },\n        \"Light23\": { binding: { groupIndex: 1, bindingIndex: 23 } },\n        \"Light24\": { binding: { groupIndex: 1, bindingIndex: 24 } },\n        \"Light25\": { binding: { groupIndex: 1, bindingIndex: 25 } },\n        \"Light26\": { binding: { groupIndex: 1, bindingIndex: 26 } },\n        \"Light27\": { binding: { groupIndex: 1, bindingIndex: 27 } },\n        \"Light28\": { binding: { groupIndex: 1, bindingIndex: 28 } },\n        \"Light29\": { binding: { groupIndex: 1, bindingIndex: 29 } },\n        \"Light30\": { binding: { groupIndex: 1, bindingIndex: 30 } },\n        \"Light31\": { binding: { groupIndex: 1, bindingIndex: 31 } },\n\n        \"Material\": { binding: { groupIndex: 2, bindingIndex: 0 } },\n        \"Mesh\":     { binding: { groupIndex: 2, bindingIndex: 1 } },\n    };\n\n    public static get KnownUBOs() {\n        return WebGPUShaderProcessingContext._SimplifiedKnownBindings ? WebGPUShaderProcessingContext._SimplifiedKnownUBOs : WebGPUShaderProcessingContext._KnownUBOs;\n    }\n\n    public shaderLanguage: ShaderLanguage;\n\n    public uboNextBindingIndex: number;\n    public freeGroupIndex: number;\n    public freeBindingIndex: number;\n\n    public availableVaryings: { [key: string]: number };\n    public availableAttributes: { [key: string]: number };\n    public availableBuffers: { [key: string]: WebGPUBufferDescription };\n    public availableTextures: { [key: string]: WebGPUTextureDescription };\n    public availableSamplers: { [key: string]: WebGPUSamplerDescription };\n\n    public leftOverUniforms: { name: string, type: string, length: number }[];\n\n    public orderedAttributes: string[];\n    public bindGroupLayoutEntries: GPUBindGroupLayoutEntry[][];\n    public bindGroupLayoutEntryInfo: WebGPUBindGroupLayoutEntryInfo[][];\n    public bindGroupEntries: GPUBindGroupEntry[][];\n    public bufferNames: string[]; // list of all uniform/storage buffer names used in the shader\n    public textureNames: string[]; // list of all texture names used in the shader\n    public samplerNames: string[]; // list of all sampler names used in the shader\n    public attributeNamesFromEffect: string[];\n    public attributeLocationsFromEffect: number[];\n\n    private _attributeNextLocation: number;\n    private _varyingNextLocation: number;\n\n    constructor(shaderLanguage: ShaderLanguage) {\n        this.shaderLanguage = shaderLanguage;\n\n        this._attributeNextLocation = 0;\n        this._varyingNextLocation = 0;\n        this.freeGroupIndex = 0;\n        this.freeBindingIndex = 0;\n\n        this.availableVaryings = {};\n        this.availableAttributes = {};\n        this.availableBuffers = {};\n        this.availableTextures = {};\n        this.availableSamplers = {};\n\n        this.orderedAttributes = [];\n        this.bindGroupLayoutEntries = [];\n        this.bindGroupLayoutEntryInfo = [];\n        this.bindGroupEntries = [];\n        this.bufferNames = [];\n        this.textureNames = [];\n        this.samplerNames = [];\n\n        this.leftOverUniforms = [];\n\n        this._findStartingGroupBinding();\n    }\n\n    private _findStartingGroupBinding(): void {\n        const knownUBOs = WebGPUShaderProcessingContext.KnownUBOs;\n\n        const groups: number[] = [];\n        for (const name in knownUBOs) {\n            const binding = knownUBOs[name].binding;\n            if (binding.groupIndex === -1) {\n                continue;\n            }\n            if (groups[binding.groupIndex] === undefined) {\n                groups[binding.groupIndex] = binding.bindingIndex;\n            } else {\n                groups[binding.groupIndex] = Math.max(groups[binding.groupIndex], binding.bindingIndex);\n            }\n        }\n\n        this.freeGroupIndex = groups.length - 1;\n        if (this.freeGroupIndex === 0) {\n            this.freeGroupIndex++;\n            this.freeBindingIndex = 0;\n        } else {\n            this.freeBindingIndex = groups[groups.length - 1] + 1;\n        }\n    }\n\n    public getAttributeNextLocation(dataType: string, arrayLength: number = 0): number {\n        const index = this._attributeNextLocation;\n\n        this._attributeNextLocation += (_typeToLocationSize[dataType] ?? 1) * (arrayLength || 1);\n\n        return index;\n    }\n\n    public getVaryingNextLocation(dataType: string, arrayLength: number = 0): number {\n        const index = this._varyingNextLocation;\n\n        this._varyingNextLocation += (_typeToLocationSize[dataType] ?? 1) * (arrayLength || 1);\n\n        return index;\n    }\n\n    public getNextFreeUBOBinding() {\n        return this._getNextFreeBinding(1);\n    }\n\n    private _getNextFreeBinding(bindingCount: number) {\n        if (this.freeBindingIndex > _maxBindingsPerGroup - bindingCount) {\n            this.freeGroupIndex++;\n            this.freeBindingIndex = 0;\n        }\n\n        if (this.freeGroupIndex === _maxGroups) {\n            throw \"Too many textures or UBOs have been declared and it is not supported in WebGPU.\";\n        }\n\n        const returnValue = {\n            groupIndex: this.freeGroupIndex,\n            bindingIndex: this.freeBindingIndex\n        };\n\n        this.freeBindingIndex += bindingCount;\n\n        return returnValue;\n    }\n}"]}